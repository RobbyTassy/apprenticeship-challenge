<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Kanban app</title>
  </head>
  <body>
    <div id="app"></div>

    <script>
      var cart = [];
      var Item = function(name, price, count) {
        this.name = name
        this.price = price
        this.count = count
      };

      function addItemToCart(name, price, count) {
        for (var i in cart) { //loop through each existing (i)tem in cart
          if (cart[i].name === name) { //for each (i)tem in cart, compare to name of users input
              cart[i].count += count; //if names are identical, add users count to existing item's count
              return; //ends functions
          }
        }
        var item = new Item(name, price, count); //creates users item
        cart.push(item); //add users item to cart
        saveCart();
      }

      //in running addItemToCart test, I learned that count++ would not work because user may specify that
      //he or she may want to add 4 or 5 more apples. With count++, it only ever adds one at a time. 'count += count' adds
      //the amount the user specifies with the existing amount in the cart.


      function removeItemFromCart(name) {
        for (var i in cart) { //loop through each existing item in the cart
          if (cart[i].name === name) { //for each item in cart, compare to name of user's input
            cart[i].count -=1; //if identical, subtract one from exising count in cart
            if (cart[i].count <= 0) { //if the existing count is less or equal to 0,
              cart.splice(i, 1); //remove one item at the array (so it doesn't show at all)
            }
            break; //ends function
          }
        }
        saveCart()
      }


      //in running removeItemFromCart test, I learned that a user could delete so many
      //as to have a negative amount. I tested against this by reassigning any negative values back to 0.


      function removeItemFromCartAll(name) {
        for (var i in cart) { //loop through each existing item in the cart
          if (cart[i].name === name) { //for each item in cart, compare to name of user's input
            cart.splice(i, 1);// if identical, remove the one item at the array
            break;  //ends function
          }
        }
        saveCart();
      }

      addItemToCart("Pear", 1.72, 3);
      addItemToCart("Pear", 1.72, 3);
      addItemToCart("Apple", 1.22, 1);
      addItemToCart("Apple", 1.22, 1);
      addItemToCart("Banana", 1.00, 1);
      addItemToCart("Car", 34.00, 1);
      addItemToCart("Plush Toy", 5.82, 1);
      addItemToCart("Sticky Notes", 4.00, 1);

      console.log(cart.length);
      console.log(cart);

      removeItemFromCartAll("Car");

      console.log(cart.length);
      console.log(cart);


      function clearCart() {
        cart = [];
        console.log('All items have been removed');
        saveCart();
      }


      function countCart() {
        var totalCount = 0;  //setting an initial value of 0...
        for (var i in cart) {//loop through each existing item
          totalCount += cart[i].count; //and add one for each existing item
        }
        return totalCount; //end function
      }


      function totalCart() {
        var totalCost = 0;
        for (var i in cart) {
            totalCost += cart[i].price;
        }
        return totalCost;
      }


      function listCart() {
        var cartCopy = [];
        for (var i in cart) {
          var item = cart[i];
          var itemCopy = {};
          for (var p in item) {
            itemCopy[p] = item[p];
          }
          cartCopy.push(itemCopy);
        }
        return cartCopy;
      }

      // Revisit video 12
      // **********************************
      var array = listCart();
      array[0].name = "Mistake";
      console.log( array )



      function saveCart() {
        localStorage.setItem("shoppingCart", JSON.stringify(cart));
      }


      //loadCart()


    </script>

    <script src="./bundle.js"></script>
  </body>
</html>
